# Malware-Classification-using-Machine-Learning-with-Graphs

The following is the code implementation of [Learning Discriminative Representations for Malware Family Classification](https://link.springer.com/chapter/10.1007/978-3-031-27409-1_121).

## Introduction
In this research, we used Machine Learning on Graphs methods namely Graph2Vec and GL2Vec to generate expressive low-dimensional vectors of malware behavior graphs. These vectors, which capture the different structural properties of the behavior graphs, are then used for downstream classification task.

## Dataset
From the [Malrec Dataset](https://giantpanda.gtisc.gatech.edu/malrec/dataset/), we collected 7000 malware samples from 14 differ-ent families (500 malware per family). We confirmed their assigned families by majority voting between the antivirus software correctly identifying the samples as malicious.

## Method
We parse malware system call traces and generate behavior graphs based on their data dependency.
![alt text](https://github.com/AymanELS/Malware-Classification-using-Machine-Learning-with-Graphs/blob/main/trace_to_graph.JPG)
Then we the following methods to embedd the behavior graphs into a lower dimensional space. These embedding are then used as feature vectors to classify malware behavior graphs into different families.

Graph2Vec:
![alt text]()
Source: [graph2vec: Learning Distributed Representations of Graphs](https://arxiv.org/abs/1707.05005)

GL2Vec:
![alt text]()
Source: [gl2vec: Learning Feature Representation Using Graphlets for Directed Networks](https://arxiv.org/abs/1812.05473v2)
## Results
